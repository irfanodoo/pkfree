<?xml version="1.0" encoding="UTF-8" ?>
<odoo>
    <template id="cash_flow_pdf_temp_id">
        <t t-call="web.html_container">
            <t t-call="web.basic_layout">
                <div class="page">
                    <div class="col-12 row">LAHORE INSTITUTE OF MEDICAL SCIENCE</div>
                    <div class="col-12 row">Bank/Cash Position as on <span t-esc="current_date"/></div>
                    <table class="table table-bordered border-black">
                        <thead>
                            <tr style="height: 30px;">
                                <th><strong>Description</strong></th>
                                <th><strong>Cheque No.</strong></th>

                                <t t-foreach="account_data" t-as="acc">
                                    <th>
                                        <strong>
                                            <span t-esc="acc['name']"/>
                                        </strong>
                                    </th>
                                </t>
                                <th><strong>Total</strong></th>
                            </tr>
                        </thead>
<!--      table body                   -->
                        <tbody>

                            <tr style="height: 30px;">
                                <td><span> </span></td>
                                <td>

                                </td>
                                <t t-foreach="closing_total" t-as="close">
                                    <td>
                                    </td>
                                </t>
                                <td>
                                </td>
                            </tr>

<!--opening balance section-->
                            <tr style="height: 30px;">
                                <td>Opening Balance</td>
                                <td> </td>

                                <t t-foreach="account_data" t-as="acc">
                                    <td>
                                        <span t-esc="acc['balance']"/>
                                    </td>
                                </t>
                                <td>
                                    <span t-esc="total_bal"/>
                                </td>
                            </tr>

                            <tr style="height: 30px;">
                                <td><span> </span></td>
                                <td>

                                </td>
                                <t t-foreach="closing_total" t-as="close">
                                    <td>
                                    </td>
                                </t>
                                <td>
                                </td>
                            </tr>

<!--debit receipt section-->
                           <tr style="height: 30px;">
                                <td style="color: red;">Receipts</td>
                                <td></td>

                                <!-- Loop through each account to create empty columns for the header -->
                                <t t-foreach="account_data" t-as="acc">
                                    <td></td>
                                </t>

                                <td></td>
                            </tr>

<!--all debit entries section-->
                            <!-- Loop through each entry in 'all_entries' -->
                            <t t-foreach="all_entries" t-as="line" t-if="line['debit']">
                                <tr style="height: 30px;">
                                    <td><span t-esc="line['description']"/></td>
                                    <td></td>

                                    <!-- Display amount only in the matching account column -->
                                    <t t-foreach="account_data" t-as="acc">
                                        <td>
                                            <!-- Check if the entry's account matches the current column's account -->
                                            <t t-if="line['account_id'] == acc['id']">
                                                <span t-esc="'{:.2f}'.format(line['debit'])"/>
                                            </t>
                                        </td>
                                    </t>

                                    <td></td>
                                </tr>
                            </t>

<!--empty row-->
                            <tr style="height: 30px;">
                                <td><span> </span></td>
                                <td>

                                </td>
                                <t t-foreach="closing_total" t-as="close">
                                    <td>
                                    </td>
                                </t>
                                <td>
                                </td>
                            </tr>

<!--    empty row-->
                            <tr style="height: 30px;">
                                <td><span> </span></td>
                                <td>

                                </td>
                                <t t-foreach="closing_total" t-as="close">
                                    <td>
                                    </td>
                                </t>
                                <td>
                                </td>
                            </tr>

<!--total receipt of the day section-->
                            <tr style="height: 30px;">
                                <td><span>Total Receipt of the day</span> </td>
                                <td>
                                </td>
                                 <t t-foreach="today_balance" t-as="balance">
                                    <td>
                                        <span t-esc="balance"/>
                                    </td>
                                </t>
                                <td>
                                    <span t-esc="today_total"/>
                                </td>
                            </tr>

<!--empty row-->
                            <tr style="height: 30px;">
                                <td><span> </span></td>
                                <td>

                                </td>
                                <t t-foreach="closing_total" t-as="close">
                                    <td>
                                    </td>
                                </t>
                                <td>
                                </td>
                            </tr>

<!--funds available for use section-->
                            <tr style="height: 30px;">
                                <td><span>Funds Available for Use</span></td>
                                <td></td>

                                <!-- Display each account's funds -->
                                <t t-foreach="funds_available" t-as="fund">
                                        <td>
                                    <t t-foreach="account_data" t-as="acc">
                                        <!-- Show balance only if account IDs match -->
                                        <t t-if="fund['account_id'] == acc['id']">
                                            <span t-esc="'{:.2f}'.format(fund['opening_balance'] + fund['date_range_balance'])"/>
                                        </t></t>
                                    </td>

                            </t>

                            <!-- Total funds across all accounts -->
                            <td>
                                <span t-esc="'{:.2f}'.format(total_funds)"/>
                            </td>
                        </tr>

<!--empty row-->
                            <tr style="height: 30px;">
                                <td><span> </span></td>
                                <td>

                                </td>
                                <t t-foreach="closing_total" t-as="close">
                                    <td>
                                    </td>
                                </t>
                                <td>
                                </td>
                            </tr>

<!--Payment string section-->
                            <tr style="height: 30px;">
                                    <td style="color: red;"><span>Payments</span></td>
                                <td> </td>
                                <t t-foreach="funds_available" t-as="fund">

                                    <td>
                                    </td>
                                </t>
                                <td>
                                </td>
                            </tr>

<!--empty row-->
                            <tr style="height: 30px;">
                                <td><span> </span></td>
                                <td>

                                </td>
                                <t t-foreach="closing_total" t-as="close">
                                    <td>
                                    </td>
                                </t>
                                <td>
                                </td>
                            </tr>

<!--receipt payment entries section-->
                            <t t-foreach="acc_cre_list" t-as="line">
                                <!-- Only display the row if there's a credit amount -->
                                <t t-if="line['credit']">
                                    <tr style="height: 30px;">
                                        <!-- Display the journal entry description -->
                                        <td><span t-esc="line['description']"/></td>
                                        <td></td>

                                        <!-- Display amount only in the matching account column -->
                                        <t t-foreach="account_data" t-as="acc">
                                            <td>
                                                <!-- Check if the entry's account matches the current column's account -->
                                                <t t-if="line['account_id'] == acc['id']">
                                                    <span t-esc="'{:.2f}'.format(line['credit'])"/>
                                                </t>
                                            </td>
                                        </t>

                                        <td></td>
                                    </tr>
                                </t>
                            </t>


<!--empty row-->
                            <tr style="height: 30px;">
                                <td><span> </span></td>
                                <td>

                                </td>
                                <t t-foreach="closing_total" t-as="close">
                                    <td>
                                    </td>
                                </t>
                                <td>
                                </td>
                            </tr>
                            <tr style="height: 30px;">
                                <td><span> </span></td>
                                <td>

                                </td>
                                <t t-foreach="closing_total" t-as="close">
                                    <td>
                                    </td>
                                </t>
                                <td>
                                </td>
                            </tr>



<!--total payment of the period section-->
                                <tr style="height: 30px;">
                                    <td><span>Total Payment of the Period</span></td>
                                    <td> </td>

                                    <!-- Display each account's total payment -->
                                    <t t-foreach="credit_funds_available" t-as="payment">
                                        <td>
                                            <t t-foreach="account_data" t-as="acc">
                                                <!-- Check if the entry's account matches the current column's account -->
                                                <t t-if="payment['account_id'] == acc['id']">
                                                    <!-- Correctly display the credit balance for each account -->
                                                    <span t-esc="'{:.2f}'.format(payment['credit_balance'])"/>
                                                </t>
                                            </t>
                                        </td>
                                    </t>

                                    <!-- Display the total credit funds across all accounts -->
                                    <td>
                                        <span t-esc="'{:.2f}'.format(total_credit_funds)"/>
                                    </td>
                                </tr>
<!--empty row -->
                            <tr style="height: 30px;">
                                <td><span> </span></td>
                                <td>

                                </td>
                                <t t-foreach="closing_total" t-as="close">
                                    <td>
                                    </td>
                                </t>
                                <td>
                                </td>
                            </tr>


<!--closing balance section-->
                                <tr style="height: 30px;">
                                    <td><span>Closing Balance</span></td>
                                    <td>

                                    </td>

                                     <t t-foreach="closing_total" t-as="fund">
                                        <td>
                                            <t t-foreach="account_data" t-as="acc">
                                                <!-- Show balance only if account IDs match -->
                                                <t t-if="fund['account_id'] == acc['id']">
                                                    <span t-esc="'{:.2f}'.format(fund['closing_balance'])"/>
                                                </t>
                                            </t>
                                        </td>
                                    </t>

                                    <!-- Display the total closing balance -->
                                    <td>
                                        <span t-esc="'{:.2f}'.format(closing_balance)"/>
                                    </td>
                                </tr>
                        </tbody>
                    </table>

                    <div class="row col-12">
                        TDR :
                    </div>
                    <div class="row col-12">

                    </div>

                </div>
            </t>
        </t>
    </template>
</odoo>
